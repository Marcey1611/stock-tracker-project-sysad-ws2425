version: "3.9"
services:
  db:
    extends:
      file: ./database/docker-compose.yml
      service: db
    networks:
      - stockTrackerDockerNetwork

  database-service:
    extends:
      file: ./database_service/docker-compose.yml
      service: database-service
    networks:
      - stockTrackerDockerNetwork
    depends_on:
      db:
        condition: service_healthy

  detection-service:
    extends:
      file: ./detection_service/docker-compose.yml
      service: detection-service
    networks:
      - stockTrackerDockerNetwork
    depends_on:
      database-service:
        condition: service_healthy

  stock-tracker:
    extends:
      file: ./stock_tracker/docker-compose.yml
      service: stock-tracker
    networks:
      - stockTrackerDockerNetwork
    depends_on:
      database-service:
        condition: service_healthy

  mailing-service:
    extends:
      file: ./mailing_service/docker-compose.yml
      service: mailing-service
    networks:
      - stockTrackerDockerNetwork

  mosquitto:
    extends:
      file: ./mqtt_broker/docker-compose.yml
      service: mosquitto
    networks:
      - stockTrackerDockerNetwork

volumes:
  pgdata:
  
networks:
  stockTrackerDockerNetwork:
    driver: bridge
